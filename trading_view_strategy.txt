//@version=5
indicator("Volume Price Action Strategy", overlay=true)

// Input parameters
volumeMALength = input.int(20, "Volume MA Length")
priceMALength = input.int(50, "Price MA Length")
volumeThreshold = input.float(1.5, "Volume Spike Threshold")

// Calculate moving averages
volumeMA = ta.sma(volume, volumeMALength)
priceMA = ta.sma(close, priceMALength)

// Volume analysis
isVolumeSpike = volume > (volumeMA * volumeThreshold)

// Price action
bullishCandle = close > open
bearishCandle = close < open
doji = math.abs(close - open) <= (high - low) * 0.1

// Support and Resistance
pivotLengthLeft = 5
pivotLengthRight = 5
highestPoint = ta.highest(high, pivotLengthLeft)
lowestPoint = ta.lowest(low, pivotLengthLeft)

// Entry signals
longSignal = isVolumeSpike and bullishCandle and close > priceMA
shortSignal = isVolumeSpike and bearishCandle and close < priceMA

// Plotting
plot(priceMA, "Price MA", color=color.blue, linewidth=2)

// Plot volume analysis
plotshape(isVolumeSpike and bullishCandle, "Volume Spike Up", shape.triangleup, location.belowbar, color.green, size=size.small)
plotshape(isVolumeSpike and bearishCandle, "Volume Spike Down", shape.triangledown, location.abovebar, color.red, size=size.small)

// Plot entry signals
plotshape(longSignal, "Long Signal", shape.triangleup, location.belowbar, color.green, size=size.normal)
plotshape(shortSignal, "Short Signal", shape.triangledown, location.abovebar, color.red, size=size.normal)

// Plot support and resistance levels
plot(highestPoint, "Resistance", color=color.red, linewidth=1, style=plot.style_circles)
plot(lowestPoint, "Support", color=color.green, linewidth=1, style=plot.style_circles)

// Alert conditions
alertcondition(longSignal, title="Long Entry", message="Volume Price Action Long Signal")
alertcondition(shortSignal, title="Short Entry", message="Volume Price Action Short Signal") 